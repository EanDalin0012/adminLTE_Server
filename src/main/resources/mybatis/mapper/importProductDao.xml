<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.spring.adminlte.dao.ImportProductDao">
	
	<resultMap type="ImportProductDto"  id="importProductDto">
		<id property="id"	    		column="import_pro_id"/>
		<id property="productId" 		column="product_id"/>
		<id property="supplierId" 		column="supplier_id"/>
		<id property="companyId" 		column="comp_id"/>
		<id property="quantity" 		column="qty"/>
		<id property="price" 			column="price"/>
		<id property="discount" 		column="discount"/>
		<id property="total" 			column="total"/>
		<id property="currencyCode" 	column="currency_code"/>
		<id property="description" 		column="descr"/>

		<id property="createBy" 		column="create_by"/>
		<id property="modifyBy" 		column="modify_by"/>
		<id property="createDate" 		column="create_date"/>
		<id property="modifyDate" 		column="modify_date"/>
		<id property="status" 			column="status"/>
	</resultMap>

	<select id="getList" resultMap="importProductDto">
	   <![CDATA[
		  SELECT
			 tip.import_pro_id
			 , tip.product_id
			 , tip.comp_id
			 , tip.supplier_id
			 , tip.qty
			 , tip.price
			 , tip.discount
			 , tip.total
			 , tip.descr
			 , tip.currency_code
			 , tip.create_by
			 , tip.create_date
			 , tip.modify_by
			 , tip.modify_date
			 , tip.status
			 FROM tb_import_product tip
		 WHERE tip.status != #{status}
	     ]]>
	</select>

	<insert id="save" parameterType="importProductDto">
    	<![CDATA[
	    	INSERT INTO tb_import_product
			(
			 product_id
			 , comp_id
			 , supplier_id
			 , qty
			 , price
			 , discount
			 , total
			 , currency_code
			 , descr
			 , create_by
			 , create_date
			 , modify_by
			 , modify_date
			 , status
			)
			VALUES (
			#{productId}
			, #{companyId}
			, #{supplierId}
			, #{quantity}
			, #{price}
			, #{discount}
			, #{total}
			, #{currencyCode}
			, COALESCE('', #{description} )
			, #{createBy}
			, to_char(NOW(), 'YYYYMMDD')
			, #{modifyBy}
			, to_char(NOW(), 'YYYYMMDD')
			, #{status}
			)

    	]]>
    </insert>

	<select id="getValueById" resultMap="importProductDto">
	   <![CDATA[
		  SELECT
			 tip.import_pro_id
			 , tip.product_id
			 , tip.comp_id
			 , tip.supplier_id
			 , tip.qty
			 , tip.price
			 , tip.discount
			 , tip.total
			 , tip.descr
			 , tip.currency_code
			 , tip.create_by
			 , tip.create_date
			 , tip.modify_by
			 , tip.modify_date
			 , tip.status
			 FROM tb_import_product tip
		  WHERE  tip.import_pro_id = #{id}
	     ]]>
	</select>

	<select id="count" resultMap="importProductDto">
	   <![CDATA[
		  SELECT
	     	COUNT (*)
	     FROM tb_import_product
	     ]]>
	</select>

	<update id="update" parameterType="importProductDto">
		<![CDATA[
		UPDATE tb_import_product
		SET
			  product_id 		= #{productId}
			, comp_id			= #{companyId}
			, supplier_id		= #{supplierId}
			, qty				= #{quantity}
			, price 			= #{price}
			, discount			= #{discount}
			, total				= #{total}
			, descr				=  COALESCE('', #{description})
			, currency_code		= #{currencyCode}
			, modify_by			= #{modifyBy}
			, modify_date		= to_char(NOW(), 'YYYYMMDD')
			, status			= #{status}
		WHERE import_pro_id 	= #{id}
		]]>
	</update>

	<update id="delete" parameterType="importProductDto">
		<![CDATA[
		update tb_import_product
        set
            status 			 = #{status}
        where import_pro_id  = #{id}
		]]>
	</update>

</mapper>