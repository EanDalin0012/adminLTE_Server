<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.spring.adminlte.dao.ProductImageDao">
	
	<resultMap type="ProductImageDto"   		id="productImageDto">
		<id property="id"	    		column="pro_img_id"/>
		<id property="productId" 		column="pro_id"/>
		<id property="uri" 				column="pro_img_uri"/>
		<id property="imageName" 		column="pro_img_nm"/>
		<id property="size" 			column="img_size"/>
		<id property="extension" 		column="extension"/>
		<id property="createBy" 		column="pro_img_create_date"/>
		<id property="modifyBy" 		column="pro_img_modify_by"/>
		<id property="createDate" 		column="pro_img_create_by"/>
		<id property="modifyDate" 		column="pro_img_modify_date"/>
		<id property="status" 			column="pro_img_status"/>
	</resultMap>

	<select id="getList" resultMap="productImageDto">
	   <![CDATA[
			SELECT
				pro_img_id
				, pro_img_uri
				, pro_img_status
				, pro_img_create_by
				, pro_img_create_date
				, pro_img_modify_by
				, pro_img_modify_date
				, pro_id
				, pro_img_nm
				, size
				, extension
			FROM tb_pro_img
			WHERE pro_img_status != #{status}

	     ]]>
	</select>

	<insert id="save" parameterType="productImageDto">
    	<![CDATA[
	    	INSERT INTO tb_company
			(
				pro_img_uri
				, pro_img_status
				, pro_img_create_by
				, pro_img_create_date
				, pro_img_modify_by
				, pro_img_modify_date
				, pro_id
				, pro_img_nm
				, size
				, extension
			)
			VALUES (
			#{uri}
			, #{status}
			, #{createBy}
			, to_char(NOW(), 'YYYYMMDD')
			, #{modifyBy}
			, to_char(NOW(), 'YYYYMMDD')
			, #{productId}
			, #{imageName}
			, #{size}
			, #{extension}
			)
    	]]>
    </insert>

	<select id="getValueById" resultMap="productImageDto">
	   <![CDATA[
			SELECT
		  		pro_img_id
				, pro_img_uri
				, pro_img_status
				, pro_img_create_by
				, pro_img_create_date
				, pro_img_modify_by
				, pro_img_modify_date
				, pro_id
				, pro_img_nm
				, size
				, extension
			FROM tb_pro_img WHERE pro_img_id = #{id}
	     ]]>
	</select>


	<select id="getPathImage" parameterType="int" resultType="String">
	   <![CDATA[
			SELECT
				pro_img_uri
			FROM tb_pro_img WHERE pro_id = #{pro_id}
	     ]]>
	</select>

	<select id="count" resultMap="productImageDto">
	   <![CDATA[
		  SELECT
	     	COUNT (*)
	     FROM tb_pro_img
	     ]]>
	</select>

	<update id="update" parameterType="companyDto">
		<![CDATA[
		UPDATE tb_pro_img
		SET
			pro_img_uri				= #{uri}
			, pro_img_status		= #{status}
			, pro_img_modify_by		= #{modifyBy}
			, pro_img_modify_date	= to_char(NOW(), 'YYYYMMDD')
			, pro_id				= #{productId}
			, pro_img_nm			= #{imageName}
			, size					= #{size}
			, extension				= #{extension}
		WHERE pro_img_id 			= #{id}
		]]>
	</update>

	<update id="delete" parameterType="productImageDto">
		<![CDATA[
		update tb_pro_img
        set
            pro_img_status = #{status}
        where pro_img_id   = #{id}
		]]>
	</update>

</mapper>